<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>mlpack: The FunctionType policy in mlpack</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="extra-stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">mlpack
   &#160;<span id="projectnumber">3.4.2</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">The FunctionType policy in mlpack </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="Overview"></a>
Overview</h1>
<p>To represent the various types of loss functions encountered in machine learning problems, mlpack provides the <code>FunctionType</code> template parameter in the optimizer interface. The various optimizers available in the core library rely on this policy to gain the necessary information required by the optimizing algorithm.</p>
<p>The <code>FunctionType</code> template parameter required by the Optimizer class can have additional requirements imposed on it, depending on the type of optimizer used.</p>
<h1><a class="anchor" id="requirements"></a>
Interface requirements</h1>
<p>The most basic requirements for the <code>FunctionType</code> parameter are the implementations of two public member functions, with the following interface and semantics</p>
<div class="fragment"><div class="line"><span class="comment">// Evaluate the loss function at the given coordinates.</span></div><div class="line"><span class="keywordtype">double</span> Evaluate(<span class="keyword">const</span> arma::mat&amp; coordinates);</div></div><!-- fragment --><div class="fragment"><div class="line"><span class="comment">// Evaluate the gradient at the given coordinates, where &#39;gradient&#39; is an</span></div><div class="line"><span class="comment">// output parameter for the required gradient.</span></div><div class="line"><span class="keywordtype">void</span> Gradient(<span class="keyword">const</span> arma::mat&amp; coordinates, arma::mat&amp; gradient);</div></div><!-- fragment --><p>Optimizers like SGD and RMSProp require a <code>DecomposableFunctionType</code> having the following requirements</p>
<div class="fragment"><div class="line"><span class="comment">// Return the number of functions. In a data-dependent function, this would</span></div><div class="line"><span class="comment">// return the number of points in the dataset.</span></div><div class="line"><span class="keywordtype">size_t</span> NumFunctions();</div></div><!-- fragment --><div class="fragment"><div class="line"><span class="comment">// Evaluate the &#39;i&#39; th loss function. For example, for a data-dependent</span></div><div class="line"><span class="comment">// function, Evaluate(coordinates, 0) should evaluate the loss function at the</span></div><div class="line"><span class="comment">// first point in the dataset.</span></div><div class="line"><span class="keywordtype">double</span> Evaluate(<span class="keyword">const</span> arma::mat&amp; coordinates, <span class="keyword">const</span> <span class="keywordtype">size_t</span> i);</div></div><!-- fragment --><div class="fragment"><div class="line"><span class="comment">// Evaluate the gradient of the &#39;i&#39; th loss function at the given coordinates,</span></div><div class="line"><span class="comment">// where &#39;gradient&#39; is an output parameter for the required gradient.</span></div><div class="line"><span class="keywordtype">void</span> Gradient(<span class="keyword">const</span> arma::mat&amp; coordinates, <span class="keyword">const</span> <span class="keywordtype">size_t</span> i, arma::mat&amp; gradient);</div></div><!-- fragment --><p><code>ParallelSGD</code> optimizer requires a <code>SparseFunctionType</code> interface. <code>SparseFunctionType</code> requires the gradient to be in a sparse matrix (<code>arma::sp_mat</code>), as ParallelSGD, implemented with the HOGWILD! scheme of unsynchronised updates, is expected to be relevant only in situations where the individual gradients are sparse. So, the interface requires function with the following signatures</p>
<div class="fragment"><div class="line"><span class="comment">// Return the number of functions. In a data-dependent function, this would</span></div><div class="line"><span class="comment">// return the number of points in the dataset.</span></div><div class="line"><span class="keywordtype">size_t</span> NumFunctions();</div></div><!-- fragment --><div class="fragment"><div class="line"><span class="comment">// Evaluate the loss function at the given coordinates.</span></div><div class="line"><span class="keywordtype">double</span> Evaluate(<span class="keyword">const</span> arma::mat&amp; coordinates);</div></div><!-- fragment --><div class="fragment"><div class="line"><span class="comment">// Evaluate the (sparse) gradient of the &#39;i&#39; th loss function at the given</span></div><div class="line"><span class="comment">// coordinates, where &#39;gradient&#39; is an output parameter for the required</span></div><div class="line"><span class="comment">// gradient.</span></div><div class="line"><span class="keywordtype">void</span> Gradient(<span class="keyword">const</span> arma::mat&amp; coordinates, <span class="keyword">const</span> <span class="keywordtype">size_t</span> i, arma::sp_mat&amp; gradient);</div></div><!-- fragment --><p>The <code>SCD</code> optimizer requires a <code>ResolvableFunctionType</code> interface, to calculate partial gradients with respect to individual features. The optimizer requires the decision variable to be arranged in a particular fashion to allow for disjoint updates. The features should be arranged columnwise in the decision variable. For example, in <code>SoftmaxRegressionFunction</code> the decision variable has size <code>numClasses</code> x <code>featureSize</code> (+ 1 if an intercept also needs to be fit). Similarly, for <code>LogisticRegression</code>, the decision variable is a row vector, with the number of columns determined by the dimensionality of the dataset.</p>
<p>The interface expects the following member functions from the function class</p>
<div class="fragment"><div class="line"><span class="comment">// Return the number of features in the decision variable.</span></div><div class="line"><span class="keywordtype">size_t</span> NumFeatures();</div></div><!-- fragment --><div class="fragment"><div class="line"><span class="comment">// Evaluate the loss function at the given coordinates.</span></div><div class="line"><span class="keywordtype">double</span> Evaluate(<span class="keyword">const</span> arma::mat&amp; coordinates);</div></div><!-- fragment --><div class="fragment"><div class="line"><span class="comment">// Evaluate the partial gradient of the loss function with respect to the &#39;j&#39; th</span></div><div class="line"><span class="comment">// coordinate at the given coordinates, where &#39;gradient&#39; is an output parameter</span></div><div class="line"><span class="comment">// for the required gradient. The &#39;gradient&#39; matrix is supposed to be non-zero</span></div><div class="line"><span class="comment">// in the jth column, which contains the relevant partial gradient.</span></div><div class="line"><span class="keywordtype">void</span> PartialGradient(<span class="keyword">const</span> arma::mat&amp; coordinates, <span class="keyword">const</span> <span class="keywordtype">size_t</span> j, arma::sp_mat&amp; gradient);</div></div><!-- fragment --> </div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
<script type="text/javascript">
var x = document.querySelectorAll("img.formulaDsp");
var i;
for (i = 0; i < x.length; i++)
{
  x[i].width = x[i].offsetWidth / 4;
}
</script>
</html>
